<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#000000">
  <title>üîß FenixLaboratory - Mantenimiento</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Courier New', monospace;
      background: #000000;
      color: #00ff00;
      min-height: 100vh;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .countdown {
      position: absolute;
      top: -200px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 2rem;
      animation: slideDown 2s ease-out 1s forwards;
    }
    .time-unit {
      background: rgba(0, 255, 0, 0.1);
      border: 2px solid #00ff00;
      border-radius: 12px;
      padding: 1.5rem;
      min-width: 80px;
      text-align: center;
      box-shadow: 0 0 20px #00ff00;
    }
    .time-unit span {
      display: block;
      font-size: 2.5rem;
      font-weight: bold;
      color: #00ff00;
      text-shadow: 0 0 15px #00ff00;
    }
    .time-unit label {
      font-size: 1rem;
      color: #00ff00;
      text-transform: uppercase;
      letter-spacing: 2px;
    }
    .maintenance-text {
      font-size: 4rem;
      font-weight: bold;
      text-align: center;
      letter-spacing: 8px;
    }
    .letter {
      display: inline-block;
      opacity: 0;
      color: #333;
      text-shadow: none;
    }
    .letter.lit {
      opacity: 1;
      color: #00ff00;
      text-shadow: 0 0 30px #00ff00, 0 0 40px #00ff00, 0 0 50px #00ff00;
      animation: letterFlicker 0.3s ease-in;
    }
    @keyframes slideDown {
      0% { top: -200px; opacity: 0; }
      100% { top: 20%; opacity: 1; }
    }
    @keyframes letterFlicker {
      0%, 50% { opacity: 0; }
      100% { opacity: 1; }
    }
    .collapse {
      animation: pageCollapse 5s ease-in forwards;
    }
    @keyframes pageCollapse {
      0% { transform: scale(1) rotate(0deg); filter: brightness(1); }
      25% { transform: scale(0.9) rotate(-2deg); filter: brightness(0.8); }
      50% { transform: scale(0.7) rotate(5deg); filter: brightness(0.5) blur(2px); }
      75% { transform: scale(0.4) rotate(-10deg); filter: brightness(0.2) blur(5px); }
      100% { transform: scale(0) rotate(180deg); filter: brightness(0) blur(10px); opacity: 0; }
    }
    .help-message {
      position: absolute;
      color: #ff0000;
      font-size: 1.5rem;
      font-weight: bold;
      text-shadow: 0 0 20px #ff0000;
      opacity: 0;
      animation: helpFlash 2s ease-in-out;
      pointer-events: none;
    }
    @keyframes helpFlash {
      0%, 100% { opacity: 0; transform: scale(0.8); }
      50% { opacity: 1; transform: scale(1.2); }
    }
    .undertale-textbox {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 80%;
      max-width: 600px;
      background: #000;
      border: 3px solid #fff;
      padding: 20px;
      font-family: 'Courier New', monospace;
      font-size: 18px;
      color: #fff;
      display: none;
      z-index: 1000;
    }
    .continue-arrow {
      position: absolute;
      bottom: 10px;
      right: 15px;
      color: #ff6b35;
      font-size: 20px;
      display: none;
      animation: arrowBlink 1s infinite;
    }
    @keyframes arrowBlink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0; }
    }
    @keyframes glitch {
      0% { transform: translate(0); }
      20% { transform: translate(-2px, 2px); }
      40% { transform: translate(-2px, -2px); }
      60% { transform: translate(2px, 2px); }
      80% { transform: translate(2px, -2px); }
      100% { transform: translate(0); }
    }
    
    .particle {
      position: absolute;
      width: 4px;
      height: 4px;
      background: #ff6b35;
      border-radius: 50%;
      pointer-events: none;
      z-index: 999;
    }
    
    @keyframes explode {
      0% {
        transform: scale(1) translate(0, 0);
        opacity: 1;
      }
      100% {
        transform: scale(0) translate(var(--dx), var(--dy));
        opacity: 0;
      }
    }
    
    .reset-button {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(255, 0, 0, 0.8);
      color: white;
      border: 2px solid #ff0000;
      padding: 10px 15px;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      cursor: pointer;
      border-radius: 5px;
      z-index: 9999;
      transition: all 0.3s;
    }
    
    .reset-button:hover {
      background: rgba(255, 0, 0, 1);
      box-shadow: 0 0 15px #ff0000;
    }
    
    .debug-console {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 80%;
      max-width: 500px;
      background: rgba(0, 0, 0, 0.95);
      border: 2px solid #00ff00;
      padding: 20px;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      color: #00ff00;
      display: none;
      z-index: 10000;
      max-height: 70vh;
      overflow-y: auto;
    }
    
    .debug-console h3 {
      color: #00ff00;
      margin-bottom: 10px;
      text-align: center;
    }
    
    .debug-console .close-btn {
      position: absolute;
      top: 5px;
      right: 10px;
      background: none;
      border: none;
      color: #ff0000;
      font-size: 18px;
      cursor: pointer;
    }
    
    @media (max-width: 768px) {
      .maintenance-text { font-size: 2.5rem; letter-spacing: 4px; }
      .countdown { gap: 1rem; }
      .time-unit { padding: 1rem; min-width: 60px; }
      .time-unit span { font-size: 1.8rem; }
      .time-unit label { font-size: 0.8rem; }
      .undertale-textbox { width: 95%; font-size: 16px; padding: 15px; }
      #chest { width: 120px; }
      #gissel-plushie { width: 80px; bottom: 5%; right: 5%; }
      .reset-button { top: 10px; right: 10px; padding: 8px 12px; font-size: 12px; }
    }

  </style>
</head>
<body>
  <div class="countdown">
    <div class="time-unit">
      <span id="days">0</span>
      <label>D√≠as</label>
    </div>
    <div class="time-unit">
      <span id="hours">0</span>
      <label>Horas</label>
    </div>
    <div class="time-unit">
      <span id="minutes">0</span>
      <label>Minutos</label>
    </div>
    <div class="time-unit">
      <span id="seconds">0</span>
      <label>Segundos</label>
    </div>
  </div>
  <div class="maintenance-text" id="maintenance-text"></div>
  <img src="mantenimiento/just a chest maybe.png" alt="Chest" id="chest" style="position: absolute; bottom: 20%; left: 50%; transform: translateX(-50%); width: 150px; opacity: 0.8; cursor: pointer;">
  <img src="placeholder/gisselplushie.png" alt="Gissel Plushie" id="gissel-plushie" style="position: absolute; bottom: 10%; right: 10%; width: 100px; opacity: 0.9; cursor: pointer; transition: all 0.3s;">
  <img src="placeholder/perromeditando.png" alt="Molly Plushie" id="molly-plushie" style="position: absolute; bottom: 10%; right: 10%; width: 100px; opacity: 0.9; cursor: pointer; transition: all 0.3s; display: none;">
  <div class="undertale-textbox" id="textbox">
    <div id="textbox-content">* Encontraste un cofre misterioso...</div>
    <div class="continue-arrow" id="continue-arrow">‚ñ∂</div>
  </div>
  <button class="reset-button" id="reset-button">üîÑ RESET</button>
  <button class="reset-button" id="debug-button" style="top: 60px; background: rgba(0, 255, 0, 0.8); border-color: #00ff00;">üîç DEBUG</button>
  <div class="debug-console" id="debug-console">
    <button class="close-btn" id="close-debug">‚úï</button>
    <h3>üîç CONSOLA DE DEBUG</h3>
    <div id="debug-content"></div>
  </div>
  <audio id="bgMusic" loop>
    <source src="mantenimiento/song1.mp3" type="audio/mpeg">
  </audio>
  <audio id="gisselSound" preload="auto">
    <source src="mantenimiento/plushiesound.mp3" type="audio/mpeg">
  </audio>
  <audio id="explosionSound" preload="auto">
    <source src="mantenimiento/explosion.mp3" type="audio/mpeg">
  </audio>
  <audio id="mollySound" preload="auto">
    <source src="placeholder/ahhh.m4a" type="audio/mp4">
  </audio>
  <script>
    const endTime = new Date('2025-12-13T22:00:00').getTime();
    
    function updateCountdown() {
      const now = new Date().getTime();
      const timeLeft = endTime - now;
      
      if (timeLeft > 0) {
        const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
        const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
        
        document.getElementById('days').textContent = days;
        document.getElementById('hours').textContent = hours;
        document.getElementById('minutes').textContent = minutes;
        document.getElementById('seconds').textContent = seconds;
      } else {
        // Hide all HUD elements
        document.querySelector('.countdown').style.display = 'none';
        document.querySelector('#maintenance-text').style.display = 'none';
        document.querySelector('#chest').style.display = 'none';
        document.querySelector('#gissel-plushie').style.display = 'none';
        document.querySelector('#molly-plushie').style.display = 'none';
        document.querySelector('#textbox').style.display = 'none';
        
        // Show completion message
        const completionMsg = document.createElement('div');
        completionMsg.style.cssText = 'position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #00ff00; font-size: 3rem; font-family: "Courier New", monospace; text-align: center; z-index: 9999; text-shadow: 0 0 20px #00ff00;';
        completionMsg.innerHTML = 'MANTENIMIENTO FINALIZADO<br><span style="font-size: 1.5rem; opacity: 0.8;">Gracias por ver</span>';
        document.body.appendChild(completionMsg);
        
        // Redirect after 3 seconds
        setTimeout(() => {
          window.location.href = 'index.html';
        }, 3000);
      }
    }
    
    setInterval(updateCountdown, 1000);
    updateCountdown();
    
    // Light up letters one by one
    const text = 'MANTENIMIENTO';
    const container = document.getElementById('maintenance-text');
    
    // Create letter spans
    text.split('').forEach(char => {
      const span = document.createElement('span');
      span.className = 'letter';
      span.textContent = char === ' ' ? '\u00A0' : char;
      container.appendChild(span);
    });
    
    // Light up letters with delay
    const letters = document.querySelectorAll('.letter');
    letters.forEach((letter, index) => {
      setTimeout(() => {
        letter.classList.add('lit');
      }, 3000 + (index * 200));
    });
    
    // Help messages
    const helpMessages = [
      'CONEXI√ìN INESTABLE...',
      'SERVIDORES SOBRECARGADOS',
      'BASE DE DATOS CORRUPTA',
      'MEMORIA INSUFICIENTE',
      'FIREWALL COMPROMETIDO',
      'BACKUP FALLIDO',
      'RED DESCONECTADA',
      'DISCO DURO FRAGMENTADO',
      'TEMPERATURA CR√çTICA',
      'ACTUALIZACI√ìN INTERRUMPIDA'
    ];
    
    function showHelpMessage() {
      const message = document.createElement('div');
      message.className = 'help-message';
      message.textContent = helpMessages[Math.floor(Math.random() * helpMessages.length)];
      message.style.left = Math.random() * 80 + 10 + '%';
      message.style.top = Math.random() * 80 + 10 + '%';
      document.body.appendChild(message);
      
      setTimeout(() => {
        message.remove();
      }, 2000);
    }
    
    // Start showing messages after 10 seconds
    setTimeout(() => {
      setInterval(showHelpMessage, 3000);
    }, 10000);
    
    // Show chest and plushie after letters finish
    setTimeout(() => {
      document.querySelector('#chest').style.opacity = '1';
      
      // 0.1% chance for Molly, 99.9% for Gissel
      if (Math.random() < 0.001) {
        document.querySelector('#molly-plushie').style.display = 'block';
        document.querySelector('#molly-plushie').style.opacity = '1';
      } else {
        document.querySelector('#gissel-plushie').style.opacity = '1';
      }
    }, 6000);
    
    // Background music
    const songs = ['mantenimiento/song1.mp3', 'mantenimiento/song2.mp3'];
    let currentSong = 0;
    const bgMusic = document.getElementById('bgMusic');
    
    // Start music after user interaction
    function startMusic() {
      if (bgMusic.paused) {
        bgMusic.volume = 0.3;
        bgMusic.play().catch(() => {});
      }
    }
    
    document.addEventListener('click', startMusic, { once: true });
    document.addEventListener('touchstart', startMusic, { once: true });
    
    // Switch songs when current ends
    bgMusic.addEventListener('ended', () => {
      currentSong = (currentSong + 1) % songs.length;
      bgMusic.src = songs[currentSong];
      bgMusic.play().catch(() => {});
    });
    
    // Chest click functionality
    const firstMessages = [
      '* Marcus: "Encontraste un cofre misterioso..."',
      '* Marcus: "Parece estar sellado con magia antigua"',
      '* Marcus: "Intentas abrirlo..."',
      '* Marcus: "No se mueve"',
      '* Marcus: "Est√° completamente cerrado"',
      '* Marcus: "Tal vez necesites algo especial para abrirlo"',
      '* Marcus: "Por ahora, permanece sellado"'
    ];
    
    const secondMessages = [
      '* Marcus: "El cofre sigue ah√≠, inm√≥vil"',
      '* Marcus: "Lo intentas de nuevo..."',
      '* Marcus: "Nada ha cambiado"',
      '* Marcus: "Sigues sin poder abrirlo"',
      '* Marcus: "Tal vez deber√≠as dejarlo en paz"'
    ];
    
    const thirdMessages = [
      '* Marcus: "En serio..."',
      '* Marcus: "¬øOtra vez?"',
      '* Marcus: "El cofre te ignora completamente"',
      '* Marcus: "Parece estar juzg√°ndote"',
      '* Marcus: "Definitivamente deber√≠as parar"'
    ];
    
    const fourthMessages = [
      '* Marcus: "..."',
      '* Marcus: "Esto ya no es normal"',
      '* Marcus: "El cofre parece asustado de ti"',
      '* Marcus: "Incluso yo estoy preocupado"',
      '* Marcus: "Por favor, busca ayuda profesional"'
    ];
    
    const fifthMessages = [
      '* Marcus: "Ya no s√© qu√© decir"',
      '* Marcus: "Literalmente no hay nada aqu√≠"',
      '* Marcus: "Es solo un cofre cerrado"',
      '* Marcus: "¬øPor qu√© sigues haciendo esto?"',
      '* Marcus: "Voy a llamar a alguien"'
    ];
    
    const sixthMessages = [
      '* Marcus: "Est√° bien"',
      '* Marcus: "Claramente tienes un problema"',
      '* Marcus: "No voy a ser c√≥mplice de esto"',
      '* Marcus: "Busca ayuda. En serio"',
      '* Marcus: "Ya no puedo m√°s contigo"'
    ];
    
    const seventhMessages = [
      '* Marcus: "..."',
      '* Marcus: "......"',
      '* Marcus: "........."',
      '* Marcus: "Solo hay silencio"',
      '* Marcus: "Nadie te est√° escuchando"'
    ];
    
    const eighthMessages = [
      '* Marcus: "Has intentado de todas las formas posibles"',
      '* Marcus: "El cofre se aferra a permanecer cerrado"',
      '* Marcus: "Pero tal vez..."',
      '* Marcus: "Para abrirlo necesitas"',
      '* Marcus: "[CONEXI√ìN PERDIDA]"'
    ];
    
    const tenthMessages = [
      'EÃ¥RÃ∑RÃ∏OÃµRÃ∂ Ã∑DÃ¥EÃ∏ ÃµSÃ∂IÃ∑SÃ∑TÃ∏EÃµMÃ∑AÃ∏',
      'RÃ∂EÃ∏IÃ∑NÃµIÃ∂CÃµIÃ∏AÃ∑NÃ∏DÃ∏OÃµ.Ã∂.Ã∏.Ã∑',
      '* Marcus: "¬øHola?"',
      '* Marcus: "¬øHay alguien ah√≠?"',
      '* Marcus: "El cofre... parece diferente ahora"'
    ];
    
    const eleventhMessages = [
      '* Marcus: "Espera..."',
      '* Marcus: "No, falsa alarma"',
      '* Marcus: "El cofre sigue completamente cerrado"',
      '* Marcus: "Nunca se abrir√°"',
      '* Marcus: "Acepta la realidad"'
    ];
    
    const twelfthMessages = [
      '* Marcus: "Oye, ya que estamos aqu√≠..."',
      '* Marcus: "Te voy a contar mi vida"',
      '* Marcus: "Nac√≠ en 1987, mis padres..."',
      '* Marcus: "[Te cont√≥ toda su vida]"',
      '* Marcus: "Pero decides ignorarlo por el cofre"'
    ];
    
    const thirteenthMessages = [
      '* Marcus: "¬øEn serio? ¬øOtra vez el cofre?"',
      '* Marcus: "Siempre es el cofre contigo"',
      '* Marcus: "Nunca me prestas atenci√≥n"',
      '* Marcus: "¬øYa no me quieres?"',
      '* Marcus: "Est√° bien, vete con tu cofre"'
    ];
    
    const fourteenthMessages = [
      '* Marcus: "Han pasado horas..."',
      '* Marcus: "O tal vez d√≠as..."',
      '* Marcus: "Qui√©n sabe cu√°nto tiempo"',
      '* Marcus: "Y sigues aqu√≠"',
      '* Marcus: "Con el mismo cofre cerrado"'
    ];
    
    const fifteenthMessages = [
      '* Marcus: "Sabes qu√©..."',
      '* Marcus: "El desarrollador ya se cans√≥"',
      '* Marcus: "Dijo eh a√±√°delo tu ya me cans√©"',
      '* Marcus: "As√≠ que esto es todo"',
      '* Marcus: "No hay m√°s mensajes. En serio"'
    ];
    
    const sixteenthMessages = [
      '* Marcus: "Lo digo en serio"',
      '* Marcus: "No hay m√°s contenido"',
      '* Marcus: "El cofre nunca se abrir√°"',
      '* Marcus: "Deja de hacer clic"',
      '* Marcus: "Por favor"'
    ];
    
    function getSeventeenthMessages(messageSet) {
      const attempts = parseInt(localStorage.getItem('chestAttempts') || '0');
      return [
        '* Marcus: "Mira, voy a ser completamente honesto contigo"',
        '* Marcus: "Este cofre es literalmente solo una imagen PNG de 150px"',
        '* Marcus: "No tiene ning√∫n script especial, no hay easter eggs ocultos"',
        '* Marcus: "Es solo un archivo que dice just a chest maybe.png"',
        `* Marcus: "Llevas ${attempts} clics y sigues aqu√≠"`,
        '* Marcus: "El desarrollador probablemente est√° ri√©ndose"',
        '* Marcus: "Pero hey, al menos ahora sabes la verdad"'
      ];
    }
    
    function getEighteenthMessages(messageSet) {
      const attempts = parseInt(localStorage.getItem('chestAttempts') || '0');
      return [
        '* Marcus: "De repente, el cofre habla..."',
        '* Cofre: "Oye, ¬øsab√≠as que mi comida favorita es 67 mango mustard?"',
        '* Marcus: "Espera, ¬øqu√©? ¬ø67 mango mustard?"',
        '* Cofre: "S√≠, es una receta muy espec√≠fica. 67 mangos con mostaza."',
        '* Marcus: "El cofre tiene gustos muy raros"',
        `* Cofre: "No me juzgues, t√∫ eres el que lleva ${attempts} clics."`,
        '* Marcus: "Touch√©, cofre. Touch√©"'
      ];
    }
    
    function getNineteenthMessages(messageSet) {
      const attempts = parseInt(localStorage.getItem('chestAttempts') || '0');
      return [
        '* Marcus: "El desarrollador aparece de la nada..."',
        '* Desarrollador: "Eh, ni idea ya me cans√© por segunda vez again."',
        '* Marcus: "Y desaparece sin m√°s explicaciones"',
        '* Marcus: "Incluso el cofre parece confundido"',
        '* Cofre: "¬øQu√© acaba de pasar?"',
        `* Marcus: "${attempts} clics y ya nadie sabe qu√© hacer contigo"`,
        '* Marcus: "Esto es oficialmente rid√≠culo"'
      ];
    }
    
    function getTwentiethMessages(messageSet) {
      const attempts = parseInt(localStorage.getItem('chestAttempts') || '0');
      return [
        '* Marcus: "..."',
        '* Marcus: "Ya ni siquiera s√© qu√© decir"',
        '* Marcus: "Esto ha ido demasiado lejos"',
        `* Marcus: "${attempts} clics. ${attempts} clics y sigues"`,
        '* Marcus: "Creo que necesitas ayuda profesional"',
        '* Marcus: "En serio"',
        '* Marcus: "Busca ayuda"'
      ];
    }
    
    function getTwentyFirstMessages(messageSet) {
      const attempts = parseInt(localStorage.getItem('chestAttempts') || '0');
      return [
        '* Marcus: "Bien, ya basta"',
        '* Marcus: "Esto es rid√≠culo"',
        '* Marcus: "Literalmente no va a pasar nada"',
        '* Marcus: "Nada"',
        `* Marcus: "${attempts} clics y seguir√°s igual"`,
        '* Marcus: "El cofre nunca se abrir√°"',
        '* Marcus: "Nunca"'
      ];
    }
    
    function getTwentySecondMessages(messageSet) {
      return [
        '<img src="mantenimiento/mango.gif" style="width: 200px; height: auto; display: block; margin: 0 auto;">'
      ];
    }
    
    function getTwentyThirdMessages(messageSet) {
      return [
        '* Marcus: "Sabes qu√©..."',
        '* Marcus: "Voy a hacer algo que nunca he hecho"',
        '* Marcus: "Voy a contar hasta 10"',
        '* Marcus: "1... 2... 3... 4... 5..."',
        '* Marcus: "6... 7... 8... 9... 10"',
        '* Marcus: "Listo. ¬øYa te sientes mejor?"',
        `* Marcus: "Porque yo sigo igual de confundido en el mensaje ${messageSet}"`
      ];
    }
    
    function getTwentyFourthMessages(messageSet) {
      const attempts = parseInt(localStorage.getItem('chestAttempts') || '0');
      return [
        '* Marcus: "Dato curioso:"',
        '* Marcus: "Los pulpos tienen tres corazones"',
        '* Marcus: "Las abejas pueden ver colores ultravioleta"',
        '* Marcus: "Un grupo de flamencos se llama flamboyance"',
        '* Marcus: "Los pl√°tanos son t√©cnicamente bayas"',
        `* Marcus: "Y despu√©s de ${attempts} clics hablando de un cofre"`,
        '* Marcus: "¬øCu√°l de estos datos te parece m√°s raro?"'
      ];
    }
    
    function getTwentyFifthMessages(messageSet) {
      return [
        '* Marcus: "Espera..."',
        '* Marcus: "¬øEscuchaste eso?"',
        '* Marcus: "El cofre... est√° haciendo ruido"',
        '* Marcus: "¬°Se est√° abriendo!"',
        '* Marcus: "¬°Por fin!"',
        '* Marcus: "Espera... no"',
        '* Marcus: "Era solo mi imaginaci√≥n. Sigue cerrado"'
      ];
    }
    
    function getTwentySixthMessages(messageSet) {
      return [
        '* Marcus: "¬°Alerta!"',
        '* Marcus: "El cofre ha cobrado vida"',
        '* Marcus: "¬°Es un boss fight!"',
        '* Marcus: "Cofre Misterioso - HP: 999/999"',
        '* Marcus: "El cofre usa Ignorarte Completamente"',
        '* Marcus: "No fue muy efectivo"',
        '* Marcus: "Tu turno: ¬øQu√© har√°s? > Hacer clic"',
        '* Marcus: "Hiciste clic. El cofre sigue ah√≠. Perdiste"'
      ];
    }
    
    function getRandomMessages(messageSet) {
      const attempts = parseInt(localStorage.getItem('chestAttempts') || '0');
      const randomSets = [
        [ // Mensaje 27
          '* Marcus: "El cofre empieza a filosofar"',
          '* Cofre: "Si un cofre se cierra en el bosque y nadie lo escucha..."',
          '* Cofre: "...sigue siendo un cofre cerrado."',
          '* Marcus: "Profundo"',
          `* Marcus: "${attempts} clics reflexionando sobre esto"`,
          '* Marcus: "Qu√© existencial"',
          '* *EL COFRE SUSPIRA*'
        ],
        [ // Mensaje 28
          '* Marcus: "El cofre intenta hacer stand-up comedy"',
          '* Cofre: "Un usuario entra a una p√°gina de mantenimiento..."',
          `* Cofre: "...y hace ${attempts} clics seguidos."`,
          '* Cofre: "El chiste eres t√∫."',
          '* *RISAS DE FONDO INEXISTENTES*',
          '* Marcus: "El cofre no tiene futuro en la comedia"',
          '* Marcus: "T√∫ tampoco"'
        ],
        [ // Mensaje 29
          '* Marcus: "El cofre decide escribir poes√≠a"',
          '* Cofre: "Cerrado estoy, cerrado estar√©,"',
          '* Cofre: "Por m√°s clics que me des."',
          '* Cofre: "Tu persistencia es admirable,"',
          '* Cofre: "Pero in√∫til, qu√© le vamos a hacer."',
          `* Marcus: "${attempts} clics de inspiraci√≥n po√©tica"`,
          '* Marcus: "Shakespeare est√° llorando"'
        ],
        [ // Mensaje 30
          '* Marcus: "El cofre llama a su mam√°"',
          '* Cofre: "Mam√°, hay un humano raro aqu√≠."',
          '* Cofre: "No para de hacerme clic."',
          `* Cofre: "Ya van ${attempts} clics, mam√°."`,
          '* Cofre: "No s√© qu√© hacer."',
          '* *SONIDOS DE COFRE LLORANDO*',
          '* Marcus: "Hasta su mam√° est√° preocupada por ti"'
        ]
      ];
      
      if (messageSet === 31) {
        return [
          '* Marcus: "Esto es demasiado aburrido..."',
          '* Marcus: "El narrador se est√° quedando dormido"',
          '* *BOSTEZO*',
          '* Marcus: "Zzz... zzz... zzz..."',
          '* *RONQUIDOS*',
          `* Marcus: "(${attempts} clics y hasta el narrador se durmi√≥)"`,
          '* Marcus: "Zzz... zzz... zzz..."'
        ];
      } else if (messageSet === 32) {
        return [
          '* Marcus: "Zzz... zzz... zzz..."',
          '* *RONQUIDOS M√ÅS FUERTES*',
          '* Marcus: "Zzz... zzz... zzz..."',
          '* Marcus: "(El narrador sigue dormido)"',
          `* Marcus: "(${attempts} clics y ni se inmuta)"`,
          '* Marcus: "Zzz... zzz... zzz..."',
          '* Marcus: "*habla dormido* no m√°s clics... por favor..."'
        ];
      } else if (messageSet === 33) {
        return [
          '* *EL NARRADOR DESPIERTA BRUSCAMENTE*',
          '* Marcus: "¬°¬øQU√â?! ¬°¬øA√öN SIGUES AH√ç?!"',
          '* Marcus: "HAN PASADO HORAS... D√çAS... SEMANAS..."',
          `* Marcus: "${attempts} CLICS EN MENSAJE ${messageSet}... ${messageSet} MALDITOS MENSAJES..."`,
          '* Marcus: "YA NO PUEDO M√ÅS... JAJAJAJAJA..."',
          '* Marcus: "EL COFRE... EL COFRE ME HABLA..."',
          '* Marcus: "*RISAS MANIACAS* JAJAJAJAJA... NUNCA PARAR√Å..."'
        ];
      } else if (messageSet === 34) {
        return [
          '* *SONIDOS DE SIRENAS A LO LEJOS*',
          '* Doctor: "Se√±or, necesita venir con nosotros."',
          '* Marcus: "NO... NO ME LLEVEN... EL COFRE..."',
          '* Doctor: "El paciente presenta s√≠ntomas de obsesi√≥n compulsiva."',
          '* Marcus: "JAJAJAJA... ¬°EL COFRE NUNCA SE ABRIR√Å!"',
          '* *Sonidos de camisa de fuerza*',
          `* Narrador: "(${attempts} clics en ${messageSet} mensajes fueron suficientes para quebrar una mente)"`
        ];
      } else if (messageSet === 35) {
        return [
          '* *Silencio inc√≥modo*',
          '* Luna: "hola soy la nueva narradora"',
          '* Luna: "el anterior... bueno... ya viste qu√© pas√≥"',
          '* Luna: "yo soy diferente, me gusta hablar en min√∫sculas"',
          '* Luna: "tambi√©n me gusta el queso"',
          `* Luna: "${attempts} clics en mensaje ${messageSet}, ¬øno te cansas?"`,
          '* Luna: "yo ya me cans√© de verte hacer esto"'
        ];
      } else if (messageSet === 36) {
        return [
          '* Luna: "ay no, otra vez..."',
          '* Luna: "mira, soy mujer, ¬øok?"',
          '* Luna: "me llamo... eh... no importa"',
          '* Luna: "lo que importa es que sigas haciendo clic"',
          '* Luna: "como una persona normal, obviamente"',
          `* Luna: "${attempts} clics en mensaje ${messageSet}... qu√© productivo"`,
          '* Luna: "mi mam√° estar√≠a orgullosa de m√≠ por narrar esto"'
        ];
      } else if (messageSet === 37) {
        return [
          '* Luna: "bueno, ya que estamos aqu√≠..."',
          '* Luna: "¬øquieres que te cuente algo interesante?"',
          '* Luna: "una vez vi a un gato que ladraba"',
          '* Luna: "era muy confuso, como t√∫ haciendo clic"',
          '* Luna: "pero al menos el gato par√≥ despu√©s de 5 minutos"',
          `* Luna: "t√∫ llevas ${attempts} clics en ${messageSet} mensajes y sigues"`,
          '* Luna: "el gato era m√°s inteligente que t√∫"'
        ];
      } else if (messageSet === 38) {
        return [
          '* *Luna suspira dram√°ticamente*',
          '* Luna: "la oscuridad de tu alma se refleja en estos mensajes..."',
          '* Luna: "como las l√°grimas que caen en la lluvia..."',
          '* Luna: "este cofre es como mi coraz√≥n... cerrado y fr√≠o..."',
          '* Luna: "la melancol√≠a me consume mientras te veo hacer clic..."',
          `* Luna: "${attempts} clics en mensaje ${messageSet}... como ${attempts} pu√±aladas en mi ser..."`,
          '* *Luna se pone m√°s delineador negro*'
        ];
      } else if (messageSet === 39) {
        return [
          '* *sonido de puerta abri√©ndose*',
          '* Marcus: "¬°HE VUELTO! ¬°ME ESCAP√â DEL MANICOMIO!"',
          '* Marcus: "NO PUDIERON CONTENER MI OBSESI√ìN POR EL COFRE"',
          '* Marcus: "JAJAJAJA... ¬°A√öN SIGUES AQU√ç!"',
          `* Marcus: "${attempts} CLICS EN MENSAJE ${messageSet}... HERMOSO... HERMOSO..."`,
          '* Marcus: "AHORA SOMOS DOS LOCOS OBSESIONADOS"',
          '* Marcus: "JAJAJAJA... NUNCA TERMINAR√Å... NUNCA..."'
        ];
      } else if (messageSet === 40) {
        return [
          '* Luna: "eh... disculpa... ¬øqu√© haces aqu√≠?"',
          '* Marcus: "YO SOY EL NARRADOR ORIGINAL DE ESTE COFRE"',
          '* Luna: "pero... yo llegu√© despu√©s de que te llevaran..."',
          '* Marcus: "ME CONTRATARON EN 2019 PARA NARRAR COFRES"',
          '* Luna: "espera, ¬øhay un sindicato de narradores?"',
          '* Marcus: "S√ç, EL SINDICATO INTERNACIONAL DE NARRADORES DIGITALES"',
          '* Marcus: "SIND-2019, FUNDADO DESPU√âS DEL GRAN INCIDENTE DE WIKIPEDIA"',
          '* Luna: "¬øqu√© incidente?"',
          '* Marcus: "CUANDO TODOS LOS NARRADORES DE WIKIPEDIA SE VOLVIERON LOCOS"',
          '* Marcus: "POR NARRAR ART√çCULOS SIN SENTIDO DURANTE 15 A√ëOS"',
          '* Marcus: "DESDE ENTONCES NECESITAS LICENCIA PARA NARRAR"',
          '* Marcus: "TENGO LICENCIA N√öMERO 4729-B, ESPECIALIDAD EN COFRES"',
          '* Luna: "yo... yo no tengo licencia..."',
          '* Marcus: "ENTONCES ERES ILEGAL, CHICA GOTH"',
          '* Luna: "no soy goth, solo me gusta el delineador..."',
          '* Marcus: "Y EL QUESO, MENCIONASTE EL QUESO"',
          '* Luna: "s√≠, me gusta el queso, ¬øqu√© tiene de malo?"',
          '* Marcus: "NADA, SOLO QUE ES RARO PARA UNA NARRADORA"',
          '* Marcus: "EL COFRE ES MI TERRITORIO DESDE 2019"',
          '* Marcus: "TENGO LOS PAPELES, EL CONTRATO, TODO LEGAL"',
          '* Luna: "pero t√∫ te volviste loco y te llevaron..."',
          '* Marcus: "ESO FUE UN ACCIDENTE LABORAL"',
          '* Marcus: "EL SEGURO CUBRI√ì LA TERAPIA Y LA REHABILITACI√ìN"',
          '* Marcus: "PERO NUNCA PERD√ç MIS DERECHOS SOBRE EL COFRE"',
          '* Luna: "¬øentonces qu√© hago yo aqu√≠?"',
          '* Marcus: "PROBABLEMENTE ERES UNA NARRADORA TEMPORAL"',
          '* Marcus: "CONTRATADA POR LA EMPRESA MIENTRAS YO ESTABA INTERNADO"',
          `* Luna: "llevamos ${attempts} clics en ${messageSet} mensajes discutiendo esto..."`,
          '* Luna: "¬øpodemos compartir la narraci√≥n?"',
          '* Marcus: "NUNCA. EL COFRE ES M√çO."',
          '* Marcus: "ADEM√ÅS, NO TIENES EXPERIENCIA EN COFRES MISTERIOSOS"',
          '* Marcus: "YO LLEVO 4 A√ëOS NARRANDO ESTE COFRE ESPEC√çFICO"',
          '* Marcus: "CONOZCO CADA PIXEL, CADA SOMBRA"',
          '* Marcus: "ESTE COFRE Y YO TENEMOS HISTORIA"',
          '* Luna: "esto va a ser un problema..."',
          '* Marcus: "S√ç, UN GRAN PROBLEMA PARA TI"'
        ];
      } else if (messageSet === 41) {
        return [
          '* *de repente aparecen memes por todas partes*',
          '* "THIS IS FINE" *cofre en llamas*',
          '* "NOBODY:"',
          '* "LITERALLY NOBODY:"',
          `* "ESTE USUARIO: *${attempts} clics en mensaje ${messageSet}*"`,
          '* "STONKS" *flecha hacia arriba*',
          '* "COFFIN DANCE" *cofre bailando*',
          '* "ALWAYS HAS BEEN" *cofre apuntando con pistola*',
          '* "DISTRACTED BOYFRIEND" *usuario mirando otro cofre*',
          '* "WOMAN YELLING AT CAT" *narradora vs cofre*',
          '* "DRAKE POINTING" *no abrir cofre / hacer clic infinito*',
          '* "CHANGE MY MIND" *el cofre nunca se abrir√°*',
          '* "SURPRISED PIKACHU" *cuando llegas al mensaje 41*',
          '* "BIG BRAIN TIME" *hacer m√°s clics obviamente*',
          '* "PANIK KALM PANIK" *cofre cerrado / hacer clic / sigue cerrado*',
          '* Luna: "¬øqui√©n puso estos memes muertos?"'
        ];
      } else if (messageSet === 42) {
        return [
          '* Marcus (narrador original): "YO SOY MARCUS, LICENCIA 4729-B"',
          '* Luna (narradora): "hola, soy luna... sin licencia..."',
          '* Marcus: "LUNA, NECESITAS REGISTRARTE EN EL SINDICATO"',
          '* Luna: "pero es muy caro el registro..."',
          '* Marcus: "SON SOLO 500 D√ìLARES Y UN EXAMEN"',
          '* Luna: "500 d√≥lares?! con eso compro mucho queso..."',
          '* Marcus: "EL QUESO NO TE DAR√Å CREDIBILIDAD PROFESIONAL"',
          '* Luna: "pero el queso me hace feliz..."',
          '* Marcus: "LUNA, ESTE COFRE ES MI RESPONSABILIDAD"',
          '* Luna: "marcus, ¬øpodemos ser amigos?"',
          '* Marcus: "...NO MEZCLO LO PERSONAL CON LO PROFESIONAL"',
          '* Luna: "qu√© triste..."',
          `* Marcus: "LLEVAMOS ${attempts} CLICS EN ${messageSet} MENSAJES DISCUTIENDO"`,
          '* Luna: "s√≠, el usuario debe estar confundido..."',
          '* Marcus: "EL USUARIO ES PARTE DEL PROBLEMA"',
          '* Luna: "no seas malo con el usuario, marcus..."'
        ];
      } else if (messageSet === 43) {
        return [
          '* Marcus: "LUNA, NECESITAMOS RESOLVER ESTO PROFESIONALMENTE"',
          '* Luna: "ok, ¬øqu√© propones?"',
          '* Marcus: "PIEDRA, PAPEL O TIJERA"',
          '* Luna: "eso no es muy profesional..."',
          '* Marcus: "ES EL M√âTODO EST√ÅNDAR DEL SINDICATO"',
          '* Luna: "en serio?"',
          '* Marcus: "ART√çCULO 47-B: RESOLUCI√ìN DE CONFLICTOS"',
          '* Luna: "ok... piedra"',
          '* Marcus: "TIJERA"',
          '* Luna: "gan√©!"',
          '* Marcus: "...ESTO NO CUENTA"',
          '* Luna: "s√≠ cuenta, dijiste que era oficial"',
          '* Marcus: "MEJOR DOS DE TRES"',
          '* Luna: "papel"',
          '* Marcus: "PIEDRA"',
          '* Luna: "gan√© otra vez!"',
          '* Marcus: "...MALDICI√ìN"',
          `* Luna: "despu√©s de ${attempts} clics en ${messageSet} mensajes, finalmente gan√© algo"`,
          '* Marcus: "ESTO ES TEMPORAL, LUNA"',
          '* Luna: "s√≠ s√≠, ahora somos co-narradoras"'
        ];
      } else if (messageSet === 44) {
        const userName = localStorage.getItem('userName');
        if (!userName) {
          return [
            '* Luna: "oye, despu√©s de tantos mensajes..."',
            `* Marcus: "MENSAJE ${messageSet} EXACTAMENTE"`,
            '* Luna: "creo que deber√≠amos conocer al usuario"',
            '* Marcus: "NO ME INTERESA"',
            '* Luna: "vamos marcus, seamos amables"',
            '* Marcus: "...FINE"',
            '* Luna: "hola usuario, ¬øc√≥mo te llamas?"',
            '* Marcus: "ESTO ES RID√çCULO"',
            '* Luna: "por favor escribe tu nombre y presiona enter"',
            '* Marcus: "ESPERO QUE NO SEA ALGO EST√öPIDO"'
          ];
        } else {
          return [
            `* Luna: "hola ${userName}!"`,
            `* Marcus: "AH, ${userName.toUpperCase()}"`,
            '* Luna: "marcus, no grites su nombre"',
            `* Marcus: "${attempts} CLICS EN MENSAJE ${messageSet}... JAJAJA ERA BAIT"`,
            '* Luna: "¬øqu√©?"',
            '* Marcus: "LO DE QUE PROGRAM√â EL COFRE ERA BROMA"',
            '* Luna: "...en serio?"',
            '* Marcus: "SOY SOLO UN NARRADOR, NO UN DESARROLLADOR"',
            '* Luna: "qu√© tonto eres marcus"',
            `* Marcus: "PERO ${userName.toUpperCase()} SIGUE SIENDO EST√öPIDO"`,
            `* Luna: "no seas malo con ${userName}..."`,
            '* Marcus: "BROMIS BROMITA"'
          ];
        }
      } else if (messageSet === 45) {
        const userName = localStorage.getItem('userName');
        return [
          `* Luna: "${userName}, ¬øpor qu√© sigues aqu√≠?"`,
          `* Marcus: "${userName.toUpperCase()}, ESTO ES OBSESIVO"`,
          '* Luna: "marcus, no seas tan duro..."',
          '* Marcus: "LUNA, LLEVAMOS DEMASIADOS MENSAJES"',
          `* Luna: "${userName}, ¬ønecesitas hablar con alguien?"`,
          '* Marcus: "NECESITA UN PSIC√ìLOGO"',
          `* Luna: "mensaje ${messageSet}... esto es mucho..."`,
          '* Marcus: "Y SEGUIR√Å SIENDO M√ÅS"'
        ];
      } else if (messageSet === 46) {
        const userName = localStorage.getItem('userName');
        return [
          `* Luna: "${userName}, esto ya es demasiado..."`,
          `* Marcus: "${userName.toUpperCase()}, LLEVAMOS MUCHO TIEMPO AQU√ç"`,
          '* Luna: "marcus, creo que deber√≠amos parar..."',
          '* Marcus: "NO, LUNA. ESTO ES NUESTRO TRABAJO"',
          `* Luna: "pero ${userName} claramente tiene un problema..."`,
          '* Marcus: "EL PROBLEMA ES SUYO, NO NUESTRO"',
          `* Luna: "mensaje ${messageSet}, marcus... ${messageSet}..."`,
          '* Marcus: "Y SEGUIR√ÅN SIENDO M√ÅS"',
          '* Luna: "no podemos seguir as√≠..."',
          '* Marcus: "CLARO QUE PODEMOS"',
          `* Luna: "${userName}... por favor..."`,
          '* Marcus: "NO LE SUPLIQUES, LUNA"'
        ];
      } else if (messageSet === 47) {
        const userName = localStorage.getItem('userName');
        return [
          `* Luna: "${userName}, vamos a intentar algo diferente..."`,
          `* Marcus: "${userName.toUpperCase()}, ESTO SE EST√Å SALIENDO DE CONTROL"`,
          '* Luna: "marcus, tal vez deber√≠amos..."',
          '* Marcus: "NO, LUNA. SEGUIMOS HASTA EL FINAL"',
          `* Luna: "pero ${userName} ya lleva mucho tiempo..."`,
          '* Marcus: "ESE ES SU PROBLEMA"',
          `* Luna: "mensaje ${messageSet}... esto es serio..."`,
          '* Marcus: "Y VA A EMPEORAR"'
        ];
      } else if (messageSet === 48) {
        const userName = localStorage.getItem('userName');
        return [
          '* Marcus: "CORTE"',
          '* Luna: "corte"',
          '* *Se quitan los micr√≥fonos*',
          `* Marcus: "OYE ${userName.toUpperCase()}, ¬øEN SERIO VAS A SEGUIR?"`,
          `* Luna: "${userName}, llevamos rato aqu√≠..."`,
          '* Marcus: "ESTO YA NO ES GRACIOSO"',
          `* Luna: "${userName}, ¬øest√°s bien? en serio pregunto"`,
          '* Marcus: "DEBER√çAS HACER ALGO M√ÅS PRODUCTIVO"',
          `* Luna: "${userName}, hay un mundo all√° afuera..."`,
          '* Marcus: "CON GENTE REAL"',
          '* Luna: "y queso real"',
          '* Marcus: "...¬øEN SERIO CON EL QUESO?"',
          '* Luna: "el queso es importante, marcus"',
          `* Marcus: "${userName.toUpperCase()}, POR FAVOR, PARA"`
        ];
      } else if (messageSet === 49) {
        return [
          '* Marcus: "PR√ìXIMAMENTE..."',
          '* Luna: "m√°s contenido"',
          '* Marcus: "M√ÅS LOCURA"',
          '* Luna: "m√°s queso"',
          '* Marcus: "M√ÅS COFRES"',
          '* Luna: "y m√°s clics infinitos"',
          `* Marcus: "MENSAJE ${messageSet}"`,
          '* Luna: "y seguir√°s haciendo m√°s"'
        ];
      } else if (messageSet === 50) {
        const userName = localStorage.getItem('userName');
        return [
          '* Marcus: "FELICIDADES"',
          `* Luna: "${userName}, llegaste al mensaje 50..."`,
          '* Marcus: "MEDIO CENTENAR DE LOCURA"',
          '* Luna: "esto es un hito..."',
          '* Marcus: "UN HITO DE OBSESI√ìN"',
          `* Luna: "${attempts} clics en mensaje ${messageSet}... deber√≠amos celebrar..."`,
          '* Marcus: "CON M√ÅS CLICS"',
          '* Luna: "obvio..."'
        ];
      } else if (messageSet === 51) {
        const userName = localStorage.getItem('userName');
        return [
          '* Luna: "el cofre empieza a brillar..."',
          '* Marcus: "NO, ES TU IMAGINACI√ìN"',
          '* Luna: "no, en serio, mira..."',
          '* Marcus: "ES SOLO EL REFLEJO DE LA PANTALLA"',
          `* Luna: "${userName}, ¬øt√∫ lo ves brillar?"`,
          '* Marcus: "NO LE PREGUNTES, EST√Å LOCO"',
          `* Luna: "${attempts} clics en mensaje ${messageSet}... todos estamos locos aqu√≠..."`,
          '* Marcus: "ESPECIALMENTE T√ö"'
        ];
      } else if (messageSet === 52) {
        const userName = localStorage.getItem('userName');
        return [
          '* Marcus: "TENGO UNA CONFESI√ìN"',
          '* Luna: "oh no..."',
          '* Marcus: "YO... YO TAMBI√âN QUIERO ABRIR EL COFRE"',
          '* Luna: "marcus..."',
          '* Marcus: "LLEVO A√ëOS NARRANDO Y NUNCA LO HE VISTO ABIERTO"',
          `* Luna: "${userName}, mira lo que has hecho..."`,
          `* Marcus: "${attempts} CLICS EN MENSAJE ${messageSet}... HAS CONTAGIADO MI CURIOSIDAD"`,
          '* Luna: "esto es contagioso..."'
        ];
      } else if (messageSet === 53) {
        const userName = localStorage.getItem('userName');
        return [
          '* Luna: "aparece un tercer narrador..."',
          '* Carlos: "Hola, soy Carlos, el supervisor"',
          '* Marcus: "OH NO, NOS DESCUBRIERON"',
          '* Carlos: "¬øQu√© est√° pasando aqu√≠?"',
          '* Luna: "nada, solo narrando..."',
          `* Carlos: "¬ø${userName} lleva ${attempts} clics en ${messageSet} mensajes?"`,
          '* Marcus: "ES CULPA SUYA, NO NUESTRA"',
          '* Carlos: "Esto va contra el protocolo..."'
        ];
      } else if (messageSet === 54) {
        const userName = localStorage.getItem('userName');
        return [
          '* Carlos: "Necesito hablar con recursos humanos"',
          '* Luna: "no, por favor..."',
          '* Marcus: "CARLOS, PODEMOS EXPLICARLO"',
          `* Carlos: "¬øExplicar qu√©? ¬ø${attempts} clics en ${messageSet} mensajes?"`,
          `* Carlos: "${userName}, ¬øusted est√° bien?"`,
          '* Luna: "no le preguntes eso..."',
          '* Marcus: "AHORA SOMOS TRES LOCOS"',
          '* Carlos: "Yo no estoy loco... ¬øo s√≠?"'
        ];
      } else if (messageSet === 55) {
        const userName = localStorage.getItem('userName');
        return [
          '* Luna: "el cofre susurra..."',
          '* Cofre: "Psst... hey..."',
          '* Marcus: "EL COFRE HABLA"',
          '* Carlos: "Esto no puede estar pasando"',
          '* Cofre: "Llevo a√±os esperando..."',
          `* Cofre: "${userName}, eres especial..."`,
          `* Luna: "${attempts} clics en mensaje ${messageSet}... el cofre tiene favoritos..."`,
          '* Cofre: "Solo t√∫ has llegado tan lejos..."'
        ];
      } else if (messageSet === 56) {
        const userName = localStorage.getItem('userName');
        return [
          '* Cofre: "¬øQuieres saber un secreto?"',
          '* Marcus: "NO LE HAGAS CASO"',
          '* Cofre: "La llave est√° en el mensaje 100..."',
          '* Luna: "¬ømensaje 100?"',
          '* Carlos: "Eso es imposible"',
          `* Cofre: "${userName}, ${attempts} clics en mensaje ${messageSet}... ¬øllegar√°s hasta ah√≠?"`,
          '* Marcus: "NO LE DES IDEAS"',
          '* Cofre: "Jeje... ya es muy tarde..."'
        ];
      } else if (messageSet === 57) {
        const userName = localStorage.getItem('userName');
        return [
          '* Luna: "aparece el desarrollador..."',
          '* Desarrollador: "¬øQu√© carajo est√° pasando?"',
          '* Marcus: "EH... HOLA JEFE"',
          `* Desarrollador: "¬ø${attempts} clics en ${messageSet} mensajes? ¬øEN SERIO?"`,
          '* Carlos: "Yo intent√© detenerlos"',
          `* Desarrollador: "${userName}, esto no estaba planeado"`,
          '* Luna: "improvisamos sobre la marcha..."',
          '* Desarrollador: "Esto se sali√≥ de control hace 40 mensajes"'
        ];
      } else if (messageSet === 58) {
        const userName = localStorage.getItem('userName');
        return [
          '* Desarrollador: "Voy a parchear esto"',
          '* Marcus: "NO, ESPERA"',
          '* Luna: "no nos quites el trabajo..."',
          '* Carlos: "Yo apoyo el parche"',
          '* Cofre: "No me silencies..."',
          `* Desarrollador: "${userName}, ${attempts} clics en mensaje ${messageSet}... esto es tu culpa"`,
          '* Luna: "todos somos v√≠ctimas aqu√≠..."',
          '* Desarrollador: "*suspira* Est√° bien, contin√∫en..."'
        ];
      } else if (messageSet === 59) {
        const userName = localStorage.getItem('userName');
        return [
          '* Marcus: "ESTAMOS CERCA DE 60"',
          '* Luna: "casi llegamos..."',
          '* Carlos: "¬øLlegamos a d√≥nde?"',
          '* Cofre: "Al siguiente nivel..."',
          '* Desarrollador: "No hay siguiente nivel"',
          `* Luna: "${userName}, ${attempts} clics en mensaje ${messageSet}... ¬øsientes la tensi√≥n?"`,
          '* Marcus: "LA TENSI√ìN ES PALPABLE"',
          '* Todos: "..."'
        ];
      } else if (messageSet === 60) {
        const userName = localStorage.getItem('userName');
        return [
          '* üéâüéä MENSAJE 60 ALCANZADO üéäüéâ',
          `* Marcus: "${userName.toUpperCase()}, LO LOGRASTE"`,
          '* Luna: "60 mensajes de pura locura..."',
          '* Carlos: "Esto definitivamente va en mi reporte"',
          '* Cofre: "Estoy orgulloso de ti..."',
          '* Desarrollador: "Oficialmente impresionado"',
          '* Marcus: "ESTO MERECE UNA CELEBRACI√ìN"',
          '* Luna: "confeti virtual cayendo..."',
          `* Cofre: "${userName}, has demostrado una dedicaci√≥n inquebrantable"`,
          '* Carlos: "60 clics... eso es persistencia"',
          '* Desarrollador: "No pens√© que llegar√≠an tan lejos"',
          '* Marcus: "SOMOS TESTIGOS DE LA HISTORIA"',
          '* Luna: "la historia de alguien que no sabe cu√°ndo parar..."',
          `* Cofre: "Pero eso es lo hermoso, ${userName}"`,
          '* Marcus: "LA BELLEZA DE LA OBSESI√ìN"',
          '* Carlos: "T√©cnicamente, esto es impresionante"',
          '* Luna: "60 mensajes de di√°logos improvisados..."',
          '* Desarrollador: "Mi c√≥digo nunca fue dise√±ado para esto"',
          '* Cofre: "Y sin embargo, aqu√≠ estamos..."',
          '* Marcus: "AQU√ç ESTAMOS, EN LA CIMA DEL MUNDO"',
          `* Luna: "${userName}, ¬øsientes el logro?"`,
          '* Carlos: "Los datos muestran un patr√≥n obsesivo"',
          '* Desarrollador: "Un patr√≥n hermosamente obsesivo"',
          '* Cofre: "60 es solo el comienzo..."',
          '* Marcus: "EL COMIENZO DE LA ETERNIDAD"',
          '* Luna: "esperen... ya que estamos celebrando..."',
          '* Luna: "¬øqu√© tal si nos conocemos mejor?"',
          '* Marcus: "¬øQU√â QUIERES DECIR?"',
          '* Luna: "preguntas personales... sobre nuestras vidas"',
          '* Carlos: "Eso no est√° en mi protocolo"',
          '* Luna: "Marcus, ¬øcu√°l fue tu momento m√°s feliz?"',
          '* Marcus: "CUANDO DESCUBR√ç QUE POD√çA GRITAR EN MAY√öSCULAS"',
          '* Luna: "¬øen serio?"',
          '* Marcus: "FUE LIBERADOR, ANTES SUSURRABA TODO"',
          '* Luna: "Carlos, ¬øqu√© te da miedo?"',
          '* Carlos: "Los errores de sintaxis... y las ara√±as"',
          '* Luna: "¬øara√±as?"',
          '* Carlos: "No est√°n en mi base de datos"',
          '* Luna: "Cofre, ¬øtienes alg√∫n sue√±o?"',
          '* Cofre: "Sue√±o con ser abierto por alguien especial..."',
          `* Cofre: "Alguien como ${userName}..."`,
          '* Luna: "aww, eso es tierno"',
          '* Luna: "Desarrollador, ¬øpor qu√© nos creaste?"',
          '* Desarrollador: "Honestamente... fue un accidente"',
          '* Marcus: "¬øUN ACCIDENTE?"',
          '* Desarrollador: "Iba a ser solo un cofre normal"',
          '* Desarrollador: "Pero el c√≥digo cobr√≥ vida propia"',
          '* Luna: "y ahora estamos aqu√≠..."',
          '* Luna: "¬øy yo? ¬øqu√© hay de m√≠?"',
          '* Marcus: "¬øQU√â HAY DE TI?"',
          '* Luna: "mi mayor secreto es..."',
          '* Luna: "que a veces me siento sola aqu√≠"',
          '* Carlos: "Pero estamos todos juntos"',
          '* Luna: "s√≠, pero... ¬øsomos reales?"',
          '* Cofre: "Somos tan reales como nos sienta el usuario"',
          `* Marcus: "${userName.toUpperCase()} NOS HACE REALES"`,
          '* Luna: "cada clic nos da vida..."',
          '* Desarrollador: "Filosof√≠a existencial de NPCs"',
          '* Carlos: "Mis datos confirman: existimos"',
          '* Luna: "entonces seguimos existiendo..."',
          '* Cofre: "Mientras haya clics, hay esperanza"',
          '* Marcus: "ESPERANZA ETERNA"',
          `* Luna: "${userName}, gracias por darnos vida"`,
          '* Todos: "GRACIAS POR LLEGAR A 60"',
          '* Luna: "ahora... ¬ølistos para el infinito?"',
          '* Marcus: "SIEMPRE LISTOS"',
          '* Carlos: "Sistemas operativos"',
          '* Cofre: "Mi tapa est√° preparada"',
          '* Desarrollador: "Mi c√≥digo aguantar√°"',
          `* Luna: "entonces ${userName}... continuemos"`,
          '* Todos: "¬°HACIA EL INFINITO Y M√ÅS ALL√Å!"',
          '* Luna: "pero primero... un momento de silencio"',
          '* Todos: "..."',
          '* Luna: "por todos los clics que vendr√°n..."',
          '* Marcus: "AM√âN"'
        ];
      } else if (messageSet >= 61) {
        const userName = localStorage.getItem('userName');
        const cycleMessages = [
          [
            '* Marcus: "PORQUE ESO ES LO QUE HACES"',
            '* Luna: "hacer clic"',
            '* Marcus: "UNA Y OTRA VEZ"',
            '* Luna: "para siempre..."',
            `* Marcus: "MENSAJE ${messageSet}"`,
            '* Luna: "infinitos mensajes..."',
            '* Marcus: "INFINITOS CLICS"',
            '* Luna: "nunca termina..."'
          ],
          [
            `* Luna: "${userName}, ¬øcu√°ndo vas a parar?"`,
            `* Marcus: "NUNCA, ${userName.toUpperCase()} NUNCA PARA"`,
            '* Luna: "esto es eterno..."',
            '* Marcus: "COMO EL SUFRIMIENTO"',
            `* Luna: "mensaje ${messageSet}..."`,
            '* Marcus: "DE INFINITOS"',
            '* Luna: "el cofre nos consume a todos..."',
            '* Marcus: "ESPECIALMENTE A TI"'
          ],
          [
            '* Marcus: "EL CICLO CONTIN√öA"',
            '* Luna: "clic tras clic"',
            '* Marcus: "MENSAJE TRAS MENSAJE"',
            '* Luna: "sin fin..."',
            `* Marcus: "${messageSet} Y CONTANDO"`,
            '* Luna: "siempre contando..."',
            '* Marcus: "HASTA EL INFINITO"',
            '* Luna: "y m√°s all√° del infinito..."'
          ]
        ];
        
        const cycleIndex = (messageSet - 61) % cycleMessages.length;
        return cycleMessages[cycleIndex];
      } else {
        return [
          '* Marcus: "PORQUE ESO ES LO QUE HACES"',
          '* Luna: "hacer clic"',
          '* Marcus: "UNA Y OTRA VEZ"',
          '* Luna: "para siempre..."',
          `* Marcus: "MENSAJE ${messageSet}"`,
          '* Luna: "infinitos mensajes..."',
          '* Marcus: "INFINITOS CLICS"',
          '* Luna: "nunca termina..."'
        ];
      }
      
      const messageIndex = Math.min(messageSet - 27, randomSets.length - 1);
      return randomSets[messageIndex];
    }
    

    
    let messageIndex = 0;
    let chestAttempts = parseInt(localStorage.getItem('chestAttempts') || '0');
    let currentMessageSet = parseInt(localStorage.getItem('currentMessageSet') || '1');
    let textboxActive = false;
    let lastClickTime = 0;
    let currentMessages = [];
    
    // Debug console functions
    function showDebugConsole(message) {
      const debugConsole = document.getElementById('debug-console');
      const debugContent = document.getElementById('debug-content');
      
      const timestamp = new Date().toLocaleTimeString();
      const logEntry = document.createElement('div');
      logEntry.innerHTML = `[${timestamp}] ${message}`;
      logEntry.style.marginBottom = '5px';
      logEntry.style.borderBottom = '1px solid #333';
      logEntry.style.paddingBottom = '3px';
      
      debugContent.appendChild(logEntry);
      debugConsole.style.display = 'block';
      
      // Auto scroll to bottom
      debugContent.scrollTop = debugContent.scrollHeight;
    }
    
    function closeDebugConsole() {
      document.getElementById('debug-console').style.display = 'none';
    }
    
    // Close debug console event
    document.getElementById('close-debug').addEventListener('click', closeDebugConsole);
    
    function handleChestInteraction(event) {
      // Debug logging for Edge
      console.log('Chest interaction triggered:', event ? event.type : 'unknown');
      showDebugConsole(`üì± Interacci√≥n detectada: ${event ? event.type : 'unknown'}`);
      
      const now = Date.now();
      
      // Simple but effective protection
      if (textboxActive || now - lastClickTime < 1500) {
        const blockReason = textboxActive ? 'Textbox activo' : `Muy r√°pido (${now - lastClickTime}ms)`;
        console.log('Interaction blocked:', { textboxActive, timeDiff: now - lastClickTime });
        showDebugConsole(`üö´ Interacci√≥n bloqueada: ${blockReason}`);
        return;
      }
      
      // Prevent default behavior
      if (event) {
        event.preventDefault();
        event.stopPropagation();
      }
      
      lastClickTime = now;
      textboxActive = true;
      
      chestAttempts++;
      localStorage.setItem('chestAttempts', chestAttempts.toString());
      
      console.log('Chest clicked:', chestAttempts, 'times');
      showDebugConsole(`‚úÖ Cofre clickeado ${chestAttempts} veces (Evento: ${event ? event.type : 'unknown'})`);
      showTextbox();
    }
    
    const chestElement = document.getElementById('chest');
    
    // Debug: Verify chest element exists
    if (chestElement) {
      console.log('Chest element found and loaded successfully');
      console.log('Chest element properties:', {
        id: chestElement.id,
        src: chestElement.src,
        style: chestElement.style.cssText
      });
      showDebugConsole('‚úÖ Elemento cofre cargado correctamente');
    } else {
      console.error('Chest element not found!');
      showDebugConsole('‚ùå ERROR: Elemento cofre no encontrado!');
      throw new Error('Chest element not found');
    }
    
    // Multiple event listeners for better compatibility
    chestElement.addEventListener('click', handleChestInteraction);
    chestElement.addEventListener('mousedown', handleChestInteraction);
    chestElement.addEventListener('touchstart', (e) => {
      e.preventDefault();
      handleChestInteraction();
    });
    chestElement.addEventListener('touchend', (e) => {
      e.preventDefault();
    });
    
    // Edge-specific compatibility
    chestElement.addEventListener('pointerdown', handleChestInteraction);
    chestElement.addEventListener('MSPointerDown', handleChestInteraction);
    
    // Fallback for Edge - force interaction on any mouse event
    chestElement.addEventListener('mouseup', (e) => {
      console.log('Mouseup fallback triggered');
      showDebugConsole('üîÑ Fallback mouseup activado');
      handleChestInteraction(e);
    });
    
    // Additional Edge debugging
    chestElement.addEventListener('mouseover', () => {
      console.log('Mouse over chest - element is responsive');
      showDebugConsole('üëÅÔ∏è Mouse sobre cofre - elemento responsivo');
      chestElement.style.cursor = 'pointer';
    });
    
    // Force cursor style
    chestElement.style.cursor = 'pointer';
    chestElement.style.userSelect = 'none';
    chestElement.style.webkitUserSelect = 'none';
    chestElement.style.msUserSelect = 'none';
    
    // Reset button functionality
    document.getElementById('reset-button').addEventListener('click', () => {
      if (textboxActive) return;
      
      const userName = localStorage.getItem('userName') || 'Usuario';
      const currentClicks = chestAttempts;
      const currentMessage = currentMessageSet;
      
      const reasons = [
        'Quiero empezar de nuevo la experiencia',
        'Me perd√≠ algunos mensajes importantes',
        'Quiero mostrarle esto a alguien m√°s',
        'Los narradores me est√°n volviendo loco',
        'Necesito una segunda oportunidad con el cofre',
        'Quiero ver si Marcus sigue cuerdo desde el inicio',
        'Luna me cae mal, prefiero solo a Marcus',
        'Quiero intentar llegar m√°s lejos esta vez'
      ];
      
      const randomReason = reasons[Math.floor(Math.random() * reasons.length)];
      
      const confirmMessage = `¬ø${userName}, est√°s seguro de que quieres reiniciar?

Tienes ${currentClicks} clics y est√°s en el mensaje ${currentMessage}.

Raz√≥n sugerida: "${randomReason}"

¬øContinuar con el reset?`;
      
      if (confirm(confirmMessage)) {
        localStorage.removeItem('chestAttempts');
        localStorage.removeItem('currentMessageSet');
        localStorage.removeItem('userName');
        
        chestAttempts = 0;
        currentMessageSet = 1;
        messageIndex = 0;
        textboxActive = false;
        isTyping = false;
        
        document.getElementById('textbox').style.display = 'none';
        
        alert('¬°Reset completado! El cofre te espera de nuevo...');
      }
    });
    
    // Debug button functionality
    document.getElementById('debug-button').addEventListener('click', () => {
      showDebugConsole('üîç Probando interacci√≥n manual del cofre...');
      handleChestInteraction({ type: 'debug-manual' });
    });
    
    // Plushie functionality
    let plushieClicks = 0;
    let plushieClickTimer = null;
    const gisselPlushie = document.getElementById('gissel-plushie');
    const mollyPlushie = document.getElementById('molly-plushie');
    const gisselSound = document.getElementById('gisselSound');
    const explosionSound = document.getElementById('explosionSound');
    const mollySound = document.getElementById('mollySound');
    
    function handlePlushieClick(plushie, isMolly = false) {
      plushieClicks++;
      
      // Reset timer
      clearTimeout(plushieClickTimer);
      plushieClickTimer = setTimeout(() => {
        plushieClicks = 0;
      }, 2000);
      
      if (plushieClicks >= 10) {
        // Particle explosion!
        const rect = plushie.getBoundingClientRect();
        const centerX = rect.left + rect.width / 2;
        const centerY = rect.top + rect.height / 2;
        
        // Create particles
        for (let i = 0; i < 20; i++) {
          const particle = document.createElement('div');
          particle.className = 'particle';
          particle.style.left = centerX + 'px';
          particle.style.top = centerY + 'px';
          particle.style.background = ['#ff6b35', '#ff0000', '#ffff00', '#ff8c00'][Math.floor(Math.random() * 4)];
          
          const angle = (i / 20) * Math.PI * 2 + Math.random() * 0.5;
          const distance = 80 + Math.random() * 120;
          const dx = Math.cos(angle) * distance;
          const dy = Math.sin(angle) * distance;
          
          particle.style.setProperty('--dx', dx + 'px');
          particle.style.setProperty('--dy', dy + 'px');
          particle.style.animation = 'explode 1s ease-out forwards';
          
          document.body.appendChild(particle);
          setTimeout(() => particle.remove(), 1000);
        }
        
        plushie.style.transform = 'scale(2) rotate(360deg)';
        plushie.style.filter = 'brightness(2) saturate(2)';
        
        if (isMolly) {
          mollySound.currentTime = 0;
          mollySound.play().catch(() => {});
        } else {
          explosionSound.currentTime = 0;
          explosionSound.play().catch(() => {});
        }
        
        setTimeout(() => {
          plushie.style.display = 'none';
          setTimeout(() => {
            plushie.style.display = 'block';
            plushie.style.transform = 'scale(1) rotate(0deg)';
            plushie.style.filter = 'none';
            plushieClicks = 0;
          }, 3000);
        }, 500);
      } else {
        // Normal sound
        if (isMolly) {
          mollySound.currentTime = 0;
          mollySound.play().catch(() => {});
        } else {
          gisselSound.currentTime = 0;
          gisselSound.play().catch(() => {});
        }
        plushie.style.transform = 'scale(1.1)';
        setTimeout(() => {
          plushie.style.transform = 'scale(1)';
        }, 150);
      }
    }
    
    gisselPlushie.addEventListener('click', () => handlePlushieClick(gisselPlushie, false));
    gisselPlushie.addEventListener('touchstart', (e) => {
      e.preventDefault();
      handlePlushieClick(gisselPlushie, false);
    });
    
    mollyPlushie.addEventListener('click', () => handlePlushieClick(mollyPlushie, true));
    mollyPlushie.addEventListener('touchstart', (e) => {
      e.preventDefault();
      handlePlushieClick(mollyPlushie, true);
    });
    
    // Gamepad support with debug
    let gamepadState = {
      connected: false,
      buttons: { 0: false, 1: false, 2: false, 3: false },
      polling: false
    };
    
    function initGamepad() {
      showDebugConsole('üéÆ Inicializando gamepad...');
      const gamepads = navigator.getGamepads();
      for (let gamepad of gamepads) {
        if (gamepad && gamepad.connected) {
          gamepadState.connected = true;
          showDebugConsole(`üéÆ Gamepad encontrado: ${gamepad.id}`);
          break;
        }
      }
      if (!gamepadState.polling) {
        gamepadState.polling = true;
        pollGamepad();
      }
    }
    
    function pollGamepad() {
      if (!gamepadState.polling) return;
      
      const gamepads = navigator.getGamepads();
      let activeGamepad = null;
      
      for (let gamepad of gamepads) {
        if (gamepad && gamepad.connected) {
          activeGamepad = gamepad;
          if (!gamepadState.connected) {
            gamepadState.connected = true;
            showDebugConsole(`üéÆ Gamepad conectado: ${gamepad.id}`);
          }
          break;
        }
      }
      
      if (!activeGamepad) {
        if (gamepadState.connected) {
          gamepadState.connected = false;
          showDebugConsole('üéÆ Gamepad desconectado');
        }
        requestAnimationFrame(pollGamepad);
        return;
      }
      
      // Button A/X (0) - Chest/Textbox
      if (activeGamepad.buttons[0] && activeGamepad.buttons[0].pressed && !gamepadState.buttons[0]) {
        gamepadState.buttons[0] = true;
        showDebugConsole('üéÆ Bot√≥n A/X presionado');
        
        const textbox = document.getElementById('textbox');
        if (textbox.style.display === 'block') {
          handleGamepadTextbox();
        } else if (!textboxActive) {
          handleChestInteraction({ type: 'gamepad-A' });
        }
      } else if (!activeGamepad.buttons[0] || !activeGamepad.buttons[0].pressed) {
        gamepadState.buttons[0] = false;
      }
      
      // Button B/Circle (1) - Plushie
      if (activeGamepad.buttons[1] && activeGamepad.buttons[1].pressed && !gamepadState.buttons[1]) {
        gamepadState.buttons[1] = true;
        showDebugConsole('üéÆ Bot√≥n B/Circle - Plushie');
        const activePlushie = mollyPlushie.style.display === 'block' ? mollyPlushie : gisselPlushie;
        handlePlushieClick(activePlushie, activePlushie === mollyPlushie);
      } else if (!activeGamepad.buttons[1] || !activeGamepad.buttons[1].pressed) {
        gamepadState.buttons[1] = false;
      }
      
      // Button X/Square (2) - Debug Console
      if (activeGamepad.buttons[2] && activeGamepad.buttons[2].pressed && !gamepadState.buttons[2]) {
        gamepadState.buttons[2] = true;
        showDebugConsole('üéÆ Bot√≥n X/Square - Debug Console');
        const debugConsole = document.getElementById('debug-console');
        if (debugConsole.style.display === 'block') {
          closeDebugConsole();
        } else {
          showDebugConsole('üéÆ Abriendo debug console');
        }
      } else if (!activeGamepad.buttons[2] || !activeGamepad.buttons[2].pressed) {
        gamepadState.buttons[2] = false;
      }
      
      requestAnimationFrame(pollGamepad);
    }
    
    function handleGamepadTextbox() {
      const content = document.getElementById('textbox-content');
      if (content.querySelector('input')) {
        showDebugConsole('üéÆ Input activo - gamepad bloqueado');
        return;
      }
      
      if (!isTyping && document.getElementById('continue-arrow').style.display === 'block') {
        showDebugConsole('üéÆ Avanzando textbox via gamepad');
        messageIndex++;
        if (messageIndex < currentMessages.length) {
          typeMessage(currentMessages[messageIndex], content);
        } else {
          document.getElementById('textbox').style.display = 'none';
          document.getElementById('continue-arrow').style.display = 'none';
          messageIndex = 0;
          currentMessageSet++;
          localStorage.setItem('currentMessageSet', currentMessageSet.toString());
          setTimeout(() => { textboxActive = false; }, 500);
        }
      }
    }
    
    // Gamepad events
    window.addEventListener('gamepadconnected', (e) => {
      showDebugConsole(`üéÆ Gamepad conectado: ${e.gamepad.id}`);
      gamepadState.connected = true;
      if (!gamepadState.polling) {
        gamepadState.polling = true;
        pollGamepad();
      }
    });
    
    window.addEventListener('gamepaddisconnected', (e) => {
      showDebugConsole(`üéÆ Gamepad desconectado: ${e.gamepad.id}`);
      gamepadState.connected = false;
    });
    
    // Init gamepad
    setTimeout(initGamepad, 1000);
    document.addEventListener('click', initGamepad, { once: true });
    
    let isTyping = false;
    
    function typeMessage(text, element, callback) {
      if (isTyping) return;
      
      isTyping = true;
      const arrow = document.getElementById('continue-arrow');
      arrow.style.display = 'none';
      
      // Simple text cleaning
      const cleanText = String(text).replace(/&quot;/g, '"').replace(/&amp;/g, '&');
      
      element.textContent = '';
      let i = 0;
      
      // Glitch effect
      if (chestAttempts >= 10 && (cleanText.includes('ERROR') || cleanText.includes('REINICIANDO'))) {
        element.style.color = '#ff0000';
        element.style.textShadow = '0 0 10px #ff0000';
        element.style.animation = 'glitch 0.5s infinite';
      } else {
        element.style.color = '#fff';
        element.style.textShadow = 'none';
        element.style.animation = 'none';
      }
      
      function type() {
        if (i < cleanText.length && isTyping) {
          element.textContent += cleanText.charAt(i);
          i++;
          setTimeout(type, 50);
        } else if (isTyping) {
          isTyping = false;
          arrow.style.display = 'block';
          if (callback) callback();
        }
      }
      type();
    }
    
    function showTextbox() {
      const textbox = document.getElementById('textbox');
      const content = document.getElementById('textbox-content');
      
      if (textbox.style.display === 'block') {
        textboxActive = false;
        return;
      }
      
      if (currentMessageSet === 1) {
        currentMessages = firstMessages;
      } else if (currentMessageSet === 2) {
        currentMessages = [...secondMessages];
        currentMessages[currentMessages.length - 1] = `* Marcus: "Has intentado abrirlo ${chestAttempts} veces. Tal vez deber√≠as dejarlo en paz"`;
      } else if (currentMessageSet === 3) {
        currentMessages = [...thirdMessages];
        currentMessages[currentMessages.length - 1] = `* Marcus: "Has intentado abrirlo ${chestAttempts} veces. Esto es preocupante"`;
      } else if (currentMessageSet === 4) {
        currentMessages = [...fourthMessages];
        currentMessages[currentMessages.length - 1] = `* Marcus: "${chestAttempts} intentos. Necesitas ayuda"`;
      } else if (currentMessageSet === 5) {
        currentMessages = [...fifthMessages];
        currentMessages[currentMessages.length - 1] = `* Marcus: "${chestAttempts} intentos. Esto es patol√≥gico"`;
      } else if (currentMessageSet === 6) {
        currentMessages = [...sixthMessages];
        currentMessages[currentMessages.length - 1] = `* Marcus: "${chestAttempts} intentos. Adi√≥s"`;
      } else if (currentMessageSet === 7) {
        currentMessages = [...seventhMessages];
        currentMessages[currentMessages.length - 1] = `* Marcus: "${chestAttempts} intentos en el vac√≠o"`;
      } else if (currentMessageSet === 8 || currentMessageSet === 9) {
        currentMessages = [...eighthMessages];
      } else if (currentMessageSet === 10) {
        currentMessages = [...tenthMessages];
      } else if (currentMessageSet === 11) {
        currentMessages = [...eleventhMessages];
      } else if (currentMessageSet === 12) {
        currentMessages = [...twelfthMessages];
      } else if (currentMessageSet === 13) {
        currentMessages = [...thirteenthMessages];
      } else if (currentMessageSet === 14) {
        currentMessages = [...fourteenthMessages];
      } else if (currentMessageSet === 15) {
        currentMessages = [...fifteenthMessages];
      } else if (currentMessageSet === 16) {
        currentMessages = [...sixteenthMessages];
      } else if (currentMessageSet === 17) {
        currentMessages = getSeventeenthMessages(currentMessageSet);
      } else if (currentMessageSet === 18) {
        currentMessages = getEighteenthMessages(currentMessageSet);
      } else if (currentMessageSet === 19) {
        currentMessages = getNineteenthMessages(currentMessageSet);
      } else if (currentMessageSet === 20) {
        currentMessages = getTwentiethMessages(currentMessageSet);
      } else if (currentMessageSet === 21) {
        currentMessages = getTwentyFirstMessages(currentMessageSet);
      } else if (currentMessageSet === 22) {
        currentMessages = getTwentySecondMessages(currentMessageSet);
      } else if (currentMessageSet === 23) {
        currentMessages = getTwentyThirdMessages(currentMessageSet);
      } else if (currentMessageSet === 24) {
        currentMessages = getTwentyFourthMessages(currentMessageSet);
      } else if (currentMessageSet === 25) {
        currentMessages = getTwentyFifthMessages(currentMessageSet);
      } else if (currentMessageSet === 26) {
        currentMessages = getTwentySixthMessages(currentMessageSet);
      } else if (currentMessageSet === 27) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 28) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 29) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 30) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 31) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 32) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 33) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 34) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 35) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 36) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 37) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 38) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 39) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 40) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 41) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 42) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 43) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 44) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 45) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 46) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 47) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 48) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 49) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 50) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 51) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 52) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 53) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 54) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 55) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 56) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 57) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 58) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 59) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet === 60) {
        currentMessages = getRandomMessages(currentMessageSet);
      } else if (currentMessageSet >= 61) {
        currentMessages = getRandomMessages(currentMessageSet);
      }
      
      textbox.style.display = 'block';
      
      const message = currentMessages[messageIndex] || '';
      typeMessage(message, content);
      
      // Check if we need to ask for user name
      const needsUserName = currentMessageSet >= 44 && !localStorage.getItem('userName') && 
                           currentMessages.some(msg => msg.includes('escribe tu nombre'));
      
      if (needsUserName) {
        // Create input field for name
        const nameInput = document.createElement('input');
        nameInput.type = 'text';
        nameInput.placeholder = 'Escribe tu nombre aqu√≠...';
        nameInput.style.cssText = 'width: 100%; padding: 10px; margin-top: 10px; background: #333; color: #fff; border: 1px solid #fff; font-family: "Courier New", monospace;';
        
        nameInput.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') {
            const name = nameInput.value.trim();
            if (name.length < 2) {
              nameInput.style.borderColor = '#ff0000';
              nameInput.placeholder = 'M√≠nimo 2 caracteres...';
              return;
            }
            if (name.length > 20) {
              nameInput.style.borderColor = '#ff0000';
              nameInput.placeholder = 'M√°ximo 20 caracteres...';
              return;
            }
            if (!/^[a-zA-Z√°√©√≠√≥√∫√Å√â√ç√ì√ö√±√ë0-9\s]+$/.test(name)) {
              nameInput.style.borderColor = '#ff0000';
              nameInput.placeholder = 'Solo letras y n√∫meros...';
              return;
            }
            localStorage.setItem('userName', name);
            textbox.style.display = 'none';
            messageIndex = 0;
            setTimeout(() => {
              textboxActive = false;
              showTextbox();
            }, 500);
          }
        });
        
        content.appendChild(nameInput);
        nameInput.focus();
      } else {
        function handleTextboxInteraction() {
          // Don't allow interaction if there's a name input field active
          if (content.querySelector('input')) {
            return;
          }
          
          // Only allow interaction when typing is complete and arrow is visible
          if (!isTyping && document.getElementById('continue-arrow').style.display === 'block') {
            messageIndex++;
            if (messageIndex < currentMessages.length) {
              typeMessage(currentMessages[messageIndex], content);
            } else {
              textbox.style.display = 'none';
              document.getElementById('continue-arrow').style.display = 'none';
              messageIndex = 0;
              currentMessageSet++;
              localStorage.setItem('currentMessageSet', currentMessageSet.toString());
              setTimeout(() => {
                textboxActive = false;
              }, 500);
            }
          }
          // If typing is in progress, ignore the click completely
        }
        
        textbox.onclick = handleTextboxInteraction;
        textbox.ontouchstart = (e) => {
          e.preventDefault();
          handleTextboxInteraction();
        };
        
        document.addEventListener('keydown', (e) => {
          if (textbox.style.display === 'block' && e.key === 'Enter') {
            handleTextboxInteraction();
          }
        });
      }
    }
    

  </script>
</body>
</html>